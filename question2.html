<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
    crossorigin="anonymous"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"
  ></script>
  <link rel="stylesheet" href="wts.css" />
  <link rel="icon" type="image/x-icon" href="Logo_last.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Playwrite+MX:wght@100..400&display=swap"
    rel="stylesheet"
  />
  <title>Activity_5</title>
   <style>
 
 .option {
  display: block;
  width: 75%; /* Adjust to fit the grid column */
  margin: 6% 0; /* Add margin for spacing between buttons */
  padding: 10px;
  cursor: pointer;
  background-color: #f56c6c;
  color: black;
  border: none;
  border-radius: 5px;
  font-size: 1.5vw;
  font-weight: 500;
  transition: background-color 0.3s;
  box-sizing: none;
}

.option:hover {
  background-color: #0056b3;
}

    .imgdiv {
      position: relative;
    }
    .question {
     position: absolute;
  top: 50%; /* Move to 50% from the top of imgdiv */
  left: 50%; /* Move to 50% from the left of imgdiv */
  transform: translate(-50%, -50%); 
  width: 80%; /* Adjust width as needed */
 
  color: black; /* Example text color */
  font-size: 1.45rem; /* Example font size */
  text-align: center; /* Example text alignment */
  border-radius: 5px; /* Example border radius */
    
    }
 .smallbtn.active,
.smallbtn.default {
  background-color: #f56c6c; /* Red color example */
  color: #ffffff; /* White text color */
  padding: 8px 12px;
  border: none;
  border-radius: 5px;
  margin: 2px;
  cursor: pointer;
  font-weight: bold;
}
 .question-section {
  background: linear-gradient(to right, #e3f2fd, #f1f8e9);
  border-radius: 15px;
  padding: 30px;
  border: 2px solid #cfd8dc;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  min-height: 500px;
  position: relative;
  transition: all 0.3s ease-in-out;
}

.question-section:hover {
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.question-text {
  font-size: 1.8rem;
  color: #2c3e50;
  line-height: 1.6;
  margin-bottom: 25px;
  font-family: 'Itim', cursive;
  text-align: left;
  padding-left: 10px;
  border-left: 4px solid #007bff;
  background: #fff;
  padding: 15px 20px;
  border-radius: 10px;
}

.smallbtn {
  background-color: #6c757d;
  color: white;
  padding: 8px 12px;
  border: none;
  border-radius: 5px;
  margin: 2px;
  cursor: pointer;
  font-weight: bold;
}

.smallbtn:hover {
  background-color: #007bff;
}

#secondImg {
      position: absolute;
      top: 45%;
      left: 35%;
    }

    .questionButtons {
      display: flex;
      gap: 5px;
      margin-bottom: 10px;
      justify-content: center;
      flex-wrap: wrap;
      max-height: 460px;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 5px;
      border-radius: 8px;
    }

    .questionButtons::-webkit-scrollbar {
      width: 6px;
    }

    .questionButtons::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }

    .questionButtons::-webkit-scrollbar-thumb {
      background: #007bff;
      border-radius: 3px;
    }

    .questionButtons::-webkit-scrollbar-thumb:hover {
      background: #0056b3;
    }

    /* Tree Structure Styles */
    .tree-container {
      position: relative;
      height: 500px;
      background: #f8f9fa;
      border-radius: 10px;
      border: 2px dashed #dee2e6;
      overflow: hidden;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* New responsive tree wrapper */
    .tree-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 500px;
      max-height: 480px;
      background: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .tree-content {
      position: relative;
      width: 100%;
      height: 100%;
      min-height: 300px;
    }

    .tree-node {
      position: absolute;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 3px solid #007bff;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #333;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .tree-node.filled {
      background: #28a745;
      color: white;
      border-color: #28a745;
    }

    .tree-node.empty {
      background: #fff3cd;
      border-color: #ffc107;
    }

    .tree-node input {
      border: none;
      text-align: center;
      font-weight: bold;
      background: transparent;
      color: inherit;
      outline: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
    }

    .tree-line {
      position: absolute;
      background: #007bff;
      z-index: 1;
    }

   

    .question-text {
      font-size: 1.8rem;
      color: #333;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    /* Completion screen styles */
    .completion-screen {
      text-align: center;
      padding: 50px;
    }

    .completion-screen h2 {
      color: #28a745;
      font-size: 2.5rem;
      margin-bottom: 20px;
    }

    .completion-screen .emoji {
      font-size: 4rem;
      margin: 20px 0;
    }

    .message {
      font-size: 1.2rem;
      font-weight: bold;
      margin-top: 10px;
      color: black;
    }

    .flip {
      display: inline-block;
      margin-left: 10px;
    }

    /* Responsive design for tree nodes */
    @media (max-width: 1200px) {
      .tree-wrapper {
        max-width: 450px;
        max-height: 430px;
      }
      
      .tree-node {
        width: 45px;
        height: 45px;
      }
      
      .tree-node input {
        width: 28px;
        height: 28px;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 992px) {
      .tree-container {
        height: 450px;
      }
      
      .tree-wrapper {
        max-width: 400px;
        max-height: 380px;
      }
      
      .tree-node {
        width: 40px;
        height: 40px;
      }
      
      .tree-node input {
        width: 25px;
        height: 25px;
        font-size: 1.4rem;
      }
    }

    @media (max-width: 768px) {
      .tree-container {
        height: 400px;
      }
      
      .tree-wrapper {
        max-width: 350px;
        max-height: 330px;
      }
      
      .tree-node {
        width: 35px;
        height: 35px;
        font-size: 0.8rem;
      }
      
      .tree-node input {
        width: 22px;
        height: 22px;
        font-size: 0.7rem;
      }
      
      .question-text {
        font-size: 1.1rem;
      }
      
      .maindiv {
        flex-direction: column;
      }
      
      .maindiv > div {
        width: 100% !important;
        margin-bottom: 20px;
      }
    }

    @media (max-width: 576px) {
      .tree-container {
        height: 350px;
      }
      
      .tree-wrapper {
        max-width: 300px;
        max-height: 280px;
      }
      
      .tree-node {
        width: 30px;
        height: 30px;
        font-size: 0.7rem;
      }
      
      .tree-node input {
        width: 20px;
        height: 20px;
        font-size: 0.6rem;
      }
      
      .question-text {
        font-size: 1rem;
      }
    }
    
  </style>
</head>
<body>
  <audio id="cheers">
    <source src="cheers.mp3" type="audio/mpeg" />
  </audio>
  <audio id="sound" src="points.mp3"></audio>
  <audio id="fail" src="fail.mp3"></audio>

  <!-- Header Section -->
  <div
    class="header"
    style="
      width: auto;
      box-shadow: 5px 5px 10px rgb(0, 0, 0);
      padding-bottom: 10px;
    "
  >
    <img
      src="Logo.png"
      width="5%"
      style="float: left; margin-top: 25px; text-align: left"
      class="img-responsive"
    />
    <span>
      <img
        src="header.png"
        width="30%"
        height=""
        class="img-responsive"
        style="text-align: left"
      />
    </span>
  </div>
  <br />

  <center>
    <!-- Topic Heading -->
    <h1 id="heading">Factor Tree Problems</h1>
    
    <!-- Question Navigation Buttons -->
    <div id="questionButtons" class="questionButtons">
      <!-- Dynamic buttons will be inserted here -->
    </div>

    <!-- Main Content Area -->
    <div class="maindiv container-fluid d-flex">
      
      <!-- Question Section (Left Side) -->
      <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
        <div class="question-section">
          <div id="question-text" class="question-text"></div>
          <div class="btnContainer col-lg-6 col-md-6 col-sm-6 col-xs-6 mt-2">
        <button
          id="submitbtn"
          class="btn btn-lg btn-success"
          onclick="checkAnswers()"
        >
          Submit
        </button>
        <button
          id="nextbtn"
          class="btn btn-lg btn-primary"
          onclick="newques()"
          style="display: none; margin-left: 10px;"
        >
          Next
        </button>
      </div>
      <div class="messageContainer col-lg-6 col-md-6 col-sm-6 col-xs-6 mt-2">
        <p id="message" class="message"></p>
      </div>
          
          <!-- Completion Screen -->
          <div id="completion-screen" class="completion-screen" style="display: none;">
            <h2>ðŸŽ‰ Congratulations! ðŸŽ‰</h2>
            <div class="emoji">ðŸŒŸ</div>
            <p style="font-size: 1.3rem; color: #666;">You've completed all the factor trees!</p>
          </div>
        </div>
      </div>
      
      <!-- Tree Structure Section (Right Side) -->
      <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
        <div class="tree-container" id="tree-container">
          <div class="tree-wrapper" id="tree-wrapper">
            <div class="tree-content" id="tree-content">
              <svg id="tree-svg" width="100%" height="100%" style="position: absolute; top: 0; left: 0;"></svg>
            </div>
          </div>
          
        </div>
        
      </div>
    </div>

    <!-- Control Buttons -->
    <div class="container d-flex mt-4 mb-2">
      
      
    </div>

    <script>
      // Sample factor tree questions data
      const treeQuestions = [
        {
          id: 1,
          question: "Ben needs to fill in the blanks to finish the prime factor tree.",
          rootNumber: 84,
          tree: {
            position: { x: 250, y: 50 },
            value: 84,
            filled: true,
            children: [
              {
                position: { x: 180, y: 150 },
                value: 4,
                filled: true,
                children: [
                  {
                    position: { x: 130, y: 250 },
                    value: 2,
                    filled: true,
                    answer: 2
                  },
                  {
                    position: { x: 210, y: 250 },
                    value: null,
                    filled: false,
                    answer: [2]
                  }
                ]
              },
              {
                position: { x: 320, y: 150 },
                value: null,
                filled: false,
                answer: [21],
                children:[
                {
                  position: { x: 280, y: 250 },
                  value: 3,
                    filled: true,
                    answer: 3
                },
                {
                  position: { x: 380, y: 250 },
                  value: null,
                    filled: false,
                    answer: [7]
                }
                ]
              }
            ]
          }
        }
      ];

      let currentQuestion = 0;
      let currentTree = null;
      let scaleFactor = 1;

      // Function to calculate responsive scale factor
      function calculateScaleFactor() {
        const wrapper = document.getElementById('tree-wrapper');
        const wrapperWidth = wrapper.offsetWidth;
        const wrapperHeight = wrapper.offsetHeight;
        
        // Base dimensions (original design size)
        const baseWidth = 500;
        const baseHeight = 500;
        
        // Calculate scale factor to fit within wrapper
        const scaleX = wrapperWidth / baseWidth;
        const scaleY = wrapperHeight / baseHeight;
        
        // Use the smaller scale to ensure everything fits
        scaleFactor = Math.min(scaleX, scaleY, 1);
        
        return scaleFactor;
      }

      // Function to scale position based on screen size
      function scalePosition(position) {
        return {
          x: position.x * scaleFactor,
          y: position.y * scaleFactor
        };
      }

      // Function to load question into UI
      function loadQuestion() {
        if (currentQuestion >= treeQuestions.length) {
          showCompletionScreen();
          return;
        }

        const current = treeQuestions[currentQuestion];
        currentTree = JSON.parse(JSON.stringify(current.tree)); // Deep copy
        
        // Update question text
        document.getElementById('question-text').textContent = current.question;
        
        // Clear previous message
        document.getElementById('message').innerHTML = '';
        document.getElementById('nextbtn').style.display = 'none';
        document.getElementById('submitbtn').style.display = 'inline-block';
        
        // Hide completion screen
        document.getElementById('completion-screen').style.display = 'none';
        document.getElementById('question-text').style.display = 'block';
        
        // Calculate scale factor and render tree
        calculateScaleFactor();
        renderTree();
      }

      function renderTree() {
        const treeContent = document.getElementById('tree-content');
        const svg = document.getElementById('tree-svg');
        
        // Clear existing content
        treeContent.querySelectorAll('.tree-node').forEach(node => node.remove());
        svg.innerHTML = '';
        
        // Render tree recursively
        renderNode(currentTree, treeContent, svg);
      }

      function renderNode(node, container, svg, parent = null) {
        const scaledPos = scalePosition(node.position);
        const nodeSize = 50 * scaleFactor;
        
        // Create node element
        const nodeElement = document.createElement('div');
        nodeElement.className = `tree-node ${node.filled ? 'filled' : 'empty'}`;
        nodeElement.style.left = (scaledPos.x - nodeSize/2) + 'px';
        nodeElement.style.top = (scaledPos.y - nodeSize/2) + 'px';
        nodeElement.style.width = nodeSize + 'px';
        nodeElement.style.height = nodeSize + 'px';
        
        if (node.filled) {
          nodeElement.textContent = node.value;
          // nodeElement.style.fontSize = (12 * scaleFactor) + 'px';
          nodeElement.style.fontSize = "1.3rem";
        } else {
          const input = document.createElement('input');
          input.type = 'text';
          input.placeholder = '__';
          input.style.width = (nodeSize * 0.6) + 'px';
          input.style.height = (nodeSize * 0.6) + 'px';
          // input.style.fontSize = (10 * scaleFactor) + 'px';
          input.style.fontSize = "1.3rem";
          input.addEventListener('input', function() {
            node.userAnswer = parseInt(this.value) || null;
          });
          nodeElement.appendChild(input);
        }
        
        container.appendChild(nodeElement);
        
        // Draw line to parent
        if (parent) {
          const parentScaledPos = scalePosition(parent.position);
          const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
          line.setAttribute('x1', parentScaledPos.x);
          line.setAttribute('y1', parentScaledPos.y);
          line.setAttribute('x2', scaledPos.x);
          line.setAttribute('y2', scaledPos.y);
          line.setAttribute('stroke', '#007bff');
          line.setAttribute('stroke-width', Math.max(2, 3 * scaleFactor));
          svg.appendChild(line);
        }
        
        // Render children
        if (node.children) {
          node.children.forEach(child => {
            renderNode(child, container, svg, node);
          });
        }
      }

      // Function to check answers - UPDATED to handle multiple correct answers
      function checkAnswers() {
        const allCorrect = checkNodeAnswers(currentTree);
        const messageElement = document.getElementById('message');
        
        if (allCorrect) {
          messageElement.innerHTML = "Good Job! <div class='flip'>&#128512</div>";
          messageElement.style.color = 'black';
          document.getElementById('sound').play();
          document.getElementById('nextbtn').style.display = 'inline-block';
          document.getElementById('submitbtn').style.display = 'none';
        } else {
          messageElement.innerHTML = 'Try Again! <div class="flip">ðŸ˜Ž</div>';
          messageElement.style.color = 'black';
          document.getElementById('fail').play();
        }
      }

      // UPDATED function to handle multiple correct answers
      function checkNodeAnswers(node) {
        let isCorrect = true;
        
        if (!node.filled) {
          // Check if answer is an array (multiple correct answers) or single value
          if (Array.isArray(node.answer)) {
            // Check if user's answer is in the array of correct answers
            if (!node.answer.includes(node.userAnswer)) {
              isCorrect = false;
            }
          } else {
            // Original single answer check
            if (node.userAnswer !== node.answer) {
              isCorrect = false;
            }
          }
        }
        
        if (node.children) {
          node.children.forEach(child => {
            if (!checkNodeAnswers(child)) {
              isCorrect = false;
            }
          });
        }
        
        return isCorrect;
      }

      // Function to load next question
      function newques() {
        if (currentQuestion === treeQuestions.length - 1) {
          window.location.href="question1.html"
        } else {
          currentQuestion++;
          loadQuestion();
          
          // Update active class in question selection buttons
          const buttons = document.querySelectorAll('.smallbtn');
          buttons.forEach((button, index) => {
            if (index === currentQuestion) {
              button.classList.add('active');
            } else {
              button.classList.remove('active');
            }
          });
        }
      }

      function showCompletionScreen() {
        document.getElementById('heading').innerHTML = '';
        document.getElementById('question-text').style.display = 'none';
        document.getElementById('completion-screen').style.display = 'block';
        document.getElementById('tree-container').innerHTML = '<div class="tree-wrapper"><div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 4rem;">ðŸŽŠ</div></div>';
        document.getElementById('message').style.display = 'none';
        document.getElementById('nextbtn').style.display = 'none';
        document.getElementById('submitbtn').style.display = 'none';
        document.getElementById('questionButtons').style.display = 'none';
        
        const buttons = document.querySelectorAll('.smallbtn');
        buttons.forEach(button => button.classList.remove('active'));
        
        // Play celebration sound
        document.getElementById('cheers').play();
      }

      // Function to handle button clicks for specific question
      function abc(x) {
        document.getElementById('heading').innerHTML = 'Factor Tree Problems';
        document.getElementById('question-text').style.display = 'block';
        document.getElementById('completion-screen').style.display = 'none';
        document.getElementById('message').style.display = 'block';
        document.getElementById('submitbtn').style.display = 'inline-block';
        document.getElementById('questionButtons').style.display = 'flex';
        
        currentQuestion = x - 1;
        loadQuestion();

        // Remove active class from all buttons
        const buttons = document.querySelectorAll('.smallbtn');
        buttons.forEach(button => button.classList.remove('active'));

        // Add active class to the clicked button
        buttons[x - 1].classList.add('active');
      }

      // Handle window resize
      window.addEventListener('resize', function() {
        if (currentTree) {
          calculateScaleFactor();
          renderTree();
        }
      });

      // Initialize the quiz when window loads
      window.onload = function () {
        loadQuestion(); // Display the first question

        // Generate question selection buttons dynamically
        const questionButtonsContainer = document.getElementById('questionButtons');
        treeQuestions.forEach((_, index) => {
          const button = document.createElement('button');
          button.textContent = `Q${index + 12}`;
          button.classList.add('smallbtn');
          button.onclick = () => abc(index + 1);

          // Add 'active' class to the first button
          if (index === 0) {
            button.classList.add('active');
          }

          questionButtonsContainer.appendChild(button);
        });
      };
    </script>
  </center>
</body>
</html>